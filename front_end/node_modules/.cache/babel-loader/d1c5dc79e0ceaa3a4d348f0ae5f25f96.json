{"ast":null,"code":"import _slicedToArray from \"/Users/stan/Desktop/esg_demo_system/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectDestructuringEmpty from \"/Users/stan/Desktop/esg_demo_system/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectDestructuringEmpty\";\nvar _jsxFileName = \"/Users/stan/Desktop/esg_demo_system/front_end/src/pages/TreeVisualisation.js\";\nimport React, { useEffect, useRef, useState } from 'react';\nimport * as d3 from 'd3';\nimport { useParams } from 'react-router-dom';\nfunction TreeVisualisation(_ref) {\n  _objectDestructuringEmpty(_ref);\n  // const { filename } = useParams();\n  var _useParams = useParams(),\n    filenameFromParams = _useParams.filename;\n  var _useState = useState(filenameFromParams),\n    _useState2 = _slicedToArray(_useState, 2),\n    filename = _useState2[0],\n    setFilename = _useState2[1];\n  var ref = useRef();\n  useEffect(function () {\n    setFilename(filenameFromParams);\n    console.log(filenameFromParams);\n    // <-- Add this line\n    drawTree(filenameFromParams);\n  }, [filenameFromParams]);\n  var drawTree = function drawTree(filename) {\n    // clear SVG in case of any previous renders\n    d3.select(ref.current).selectAll(\"*\").remove();\n    var margin = {\n        top: 20,\n        right: 90,\n        bottom: 30,\n        left: 90\n      },\n      width = 2000 - margin.left - margin.right,\n      height = 1000 - margin.top - margin.bottom;\n    var svg = d3.select(ref.current).attr(\"width\", \"100%\").attr(\"height\", \"100%\").attr(\"viewBox\", \"0 0 \".concat(width + margin.right + margin.left, \" \").concat(height + margin.top + margin.bottom)).attr(\"preserveAspectRatio\", \"xMidYMid meet\").append(\"g\").attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n    var treemap = d3.tree().size([height, width]).separation(function (a, b) {\n      return a.parent == b.parent ? 70 : 50;\n    });\n    d3.json(\"http://localhost:3000/processed_data/\".concat(filename)).then(function (error, treeData) {\n      if (error) throw error;\n      var root = d3.hierarchy(treeData, function (d) {\n        return d.children;\n      });\n      root.x0 = height / 2;\n      root.y0 = width / 2;\n      // Collapse after the second level\n      root.children.forEach(collapse);\n      update(root);\n    }).catch(function (error) {\n      console.error(\"Error occured while fetching and processing data: \", error);\n    });\n\n    // Include your functions collapse, update, etc. here.\n    function collapse(d) {\n      if (d.children) {\n        d._children = d.children;\n        d._children.forEach(collapse);\n        d.children = null;\n      }\n    }\n    function centerNode(source) {\n      var scale = 0.8;\n      var x = -source.y0 * scale + width / 2;\n      var y = -source.x0 * scale + height / 2;\n      svg.transition().duration(750).call(d3.zoomIdentity.translate(x, y).scale(scale));\n    }\n    function update(source) {\n      // Complete update function and other related functions go here\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }, filename), /*#__PURE__*/React.createElement(\"svg\", {\n    ref: ref,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }\n  }));\n}\nexport default TreeVisualisation;","map":{"version":3,"names":["React","useEffect","useRef","useState","d3","useParams","TreeVisualisation","_ref","_objectDestructuringEmpty","_useParams","filenameFromParams","filename","_useState","_useState2","_slicedToArray","setFilename","ref","console","log","drawTree","select","current","selectAll","remove","margin","top","right","bottom","left","width","height","svg","attr","concat","append","treemap","tree","size","separation","a","b","parent","json","then","error","treeData","root","hierarchy","d","children","x0","y0","forEach","collapse","update","catch","_children","centerNode","source","scale","x","y","transition","duration","call","zoomIdentity","translate","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/stan/Desktop/esg_demo_system/front_end/src/pages/TreeVisualisation.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport * as d3 from 'd3';\nimport { useParams } from'react-router-dom';\n\nfunction TreeVisualisation({}) {\n    // const { filename } = useParams();\n    const { filename: filenameFromParams } = useParams();\n    const [filename, setFilename] = useState(filenameFromParams);\n    const ref = useRef();\n\n    useEffect(() => {\n        setFilename(filenameFromParams)\n        console.log(filenameFromParams);\n         // <-- Add this line\n        drawTree(filenameFromParams);\n    }, [filenameFromParams]);\n\n    const drawTree = (filename) => {\n        // clear SVG in case of any previous renders\n        d3.select(ref.current).selectAll(\"*\").remove();\n\n        var margin = {top: 20, right: 90, bottom: 30, left: 90},\n            width = 2000 - margin.left - margin.right,\n            height = 1000 - margin.top - margin.bottom;\n\n        var svg = d3.select(ref.current)\n            .attr(\"width\", \"100%\")\n            .attr(\"height\", \"100%\")\n            .attr(\"viewBox\", `0 0 ${width + margin.right + margin.left} ${height + margin.top + margin.bottom}`)\n            .attr(\"preserveAspectRatio\", \"xMidYMid meet\")\n            .append(\"g\")\n            .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\");\n\n        var treemap = d3.tree().size([height, width]).separation(function(a, b) {\n            return (a.parent == b.parent ? 70 : 50);\n        });\n\n        d3.json(`http://localhost:3000/processed_data/${filename}`)\n        .then(function(error, treeData) { \n            if (error) throw error;\n            var root = d3.hierarchy(treeData, function(d) { return d.children; });\n            root.x0 = height / 2;\n            root.y0 = width / 2;\n            // Collapse after the second level\n            root.children.forEach(collapse);\n            update(root);\n        })\n        .catch(error => {\n            console.error(\"Error occured while fetching and processing data: \", error);\n        });\n\n        // Include your functions collapse, update, etc. here.\n        function collapse(d) {\n            if(d.children) {\n                d._children = d.children;\n                d._children.forEach(collapse);\n                d.children = null;\n            }\n        }\n\n        function centerNode(source) {\n            let scale = 0.8;\n            let x = -source.y0 * scale + width / 2;\n            let y = -source.x0 * scale + height / 2;\n            svg.transition()\n                .duration(750)\n                .call(d3.zoomIdentity.translate(x, y).scale(scale));\n        }\n\n        function update(source) {\n            // Complete update function and other related functions go here\n        }\n        \n    }\n\n    return (\n        <div>\n            <h1>{filename}</h1>\n            {/* <h2>TESTING</h2> */}\n            <svg ref={ref}></svg>\n        </div>\n    );\n}\n\nexport default TreeVisualisation;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}