{"ast":null,"code":"var _jsxFileName = \"/Users/stan/Desktop/esg_demo_system/front_end/src/pages/WordCloud.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from 'react';\nimport * as d3 from 'd3';\nimport d3Cloud from 'd3-cloud';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WordCloud = _ref => {\n  _s();\n  let {\n    filepath,\n    category\n  } = _ref;\n  const ref = useRef();\n  const [tooltip, setTooltip] = useState({\n    content: \"\",\n    visibility: false,\n    x: 0,\n    y: 0\n  });\n  const tooltipRef = useRef();\n  useEffect(() => {\n    if (!filepath) {\n      return;\n    }\n    fetch(`http://localhost:3000/word-cloud/${btoa(filepath)}/${category}`).then(response => response.json()).then(data => {\n      if (data.error) {\n        console.error(data.error);\n        return;\n      }\n      const words = Object.entries(data).map(_ref2 => {\n        let [word, frequency] = _ref2;\n        return {\n          word,\n          frequency\n        };\n      });\n      var width = 1000;\n      var height = 720;\n      var colorInterpolate = getColorScale(category);\n      var color = d => colorInterpolate(d.frequency / d3.max(words, d => d.frequency) * 0.7 + 0.35);\n      var fontSize = d3.scalePow().exponent(0.5).domain([0, d3.max(words, d => d.frequency)]).range([10, 100]);\n      var layout = d3Cloud().size([width, height]).words(words).padding(7).rotate(() => Math.round(Math.random()) * 90).font(\"Impact\").fontSize(d => fontSize(d.frequency)).on(\"end\", draw);\n      function draw(words) {\n        d3.select(ref.current).html(\"\").append(\"svg\").attr(\"width\", layout.size()[0]).attr(\"height\", layout.size()[1]).append(\"g\").attr(\"transform\", \"translate(\" + layout.size()[0] / 2 + \",\" + layout.size()[1] / 2 + \")\").selectAll(\"text\").data(words).enter().append(\"text\").style(\"font-size\", d => d.size + \"px\").style(\"font-family\", \"Impact\").style(\"fill\", color).attr(\"text-anchor\", \"middle\").attr(\"transform\", d => \"translate(\" + [d.x, d.y] + \")rotate(\" + d.rotate + \")\").text(d => d.word).on(\"mouseover\", mouseover).on(\"mouseout\", mouseout).attr(\"class\", \"word\");\n      }\n      function darkenColor(d) {\n        return d3.rgb(color(d)).darker(1);\n      }\n      function mouseover(event, d) {\n        const totalWords = d3.sum(words, d => d.frequency);\n        const percentage = (d.frequency / totalWords * 100).toFixed(2);\n        d3.select(event.target).transition().duration(300).style(\"fill\", () => darkenColor(d)).style(\"font-size\", d.size + 5 + \"px\");\n        setTooltip({\n          content: `${d.word}: ${d.frequency} (${percentage}%)`,\n          visibility: true,\n          x: event.clientX,\n          y: event.clientY\n        });\n      }\n      function mouseout(event, d) {\n        d3.select(event.target).transition().duration(300).style(\"font-size\", d.size + \"px\").style(\"fill\", () => color(d));\n        setTooltip({\n          ...tooltip,\n          visibility: false\n        });\n      }\n      layout.start();\n    });\n  }, [filepath, category]);\n  const getColorScale = category => {\n    switch (category) {\n      case \"environmental\":\n        return d3.interpolateGreens;\n      case \"social\":\n        return d3.interpolateOranges;\n      case \"governance\":\n        return d3.interpolateBlues;\n      default:\n        return d3.interpolateBlues;\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      ref: ref\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 13\n    }, this), tooltip.visibility && /*#__PURE__*/_jsxDEV(\"div\", {\n      ref: tooltipRef,\n      style: {\n        position: \"absolute\",\n        left: tooltip.x,\n        top: tooltip.y,\n        background: \"rgba(0, 0, 0, 0.7)\",\n        color: \"#fff\",\n        padding: \"3px 8px\",\n        borderRadius: \"4px\",\n        pointerEvents: \"none\",\n        fontSize: \"14px\",\n        transform: 'translate(-50%, -100%)'\n      },\n      children: tooltip.content\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 9\n  }, this);\n};\n_s(WordCloud, \"2r8iOifhsJVttixa8f+JK7WRt1M=\");\n_c = WordCloud;\nexport default WordCloud;\nvar _c;\n$RefreshReg$(_c, \"WordCloud\");","map":{"version":3,"names":["React","useEffect","useRef","useState","d3","d3Cloud","jsxDEV","_jsxDEV","WordCloud","_ref","_s","filepath","category","ref","tooltip","setTooltip","content","visibility","x","y","tooltipRef","fetch","btoa","then","response","json","data","error","console","words","Object","entries","map","_ref2","word","frequency","width","height","colorInterpolate","getColorScale","color","d","max","fontSize","scalePow","exponent","domain","range","layout","size","padding","rotate","Math","round","random","font","on","draw","select","current","html","append","attr","selectAll","enter","style","text","mouseover","mouseout","darkenColor","rgb","darker","event","totalWords","sum","percentage","toFixed","target","transition","duration","clientX","clientY","start","interpolateGreens","interpolateOranges","interpolateBlues","children","fileName","_jsxFileName","lineNumber","columnNumber","position","left","top","background","borderRadius","pointerEvents","transform","_c","$RefreshReg$"],"sources":["/Users/stan/Desktop/esg_demo_system/front_end/src/pages/WordCloud.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport * as d3 from 'd3';\nimport d3Cloud from 'd3-cloud';\n\nconst WordCloud = ({ filepath, category }) => {\n    const ref = useRef();\n    const [tooltip, setTooltip] = useState({content: \"\", visibility: false, x: 0, y: 0});\n    const tooltipRef = useRef();\n\n    useEffect(() => {\n        if (!filepath) {\n            return;\n        }\n        fetch(`http://localhost:3000/word-cloud/${btoa(filepath)}/${category}`)\n        .then(response => response.json())\n        .then(data => {\n            if (data.error) {\n                console.error(data.error);\n                return;\n            }\n\n            const words = Object.entries(data).map(([word, frequency]) => ({ word, frequency }));\n\n            var width = 1000;\n            var height = 720;\n            var colorInterpolate = getColorScale(category);\n            var color = d => colorInterpolate((d.frequency / d3.max(words, d => d.frequency)) * 0.7 + 0.35);\n\n            var fontSize = d3.scalePow().exponent(0.5).domain([0, d3.max(words, d => d.frequency)]).range([10, 100]);\n            var layout = d3Cloud().size([width, height]).words(words).padding(7).rotate(() => Math.round(Math.random()) * 90).font(\"Impact\").fontSize(d => fontSize(d.frequency)).on(\"end\", draw);\n\n            function draw(words) {\n                d3.select(ref.current).html(\"\").append(\"svg\")\n                    .attr(\"width\", layout.size()[0])\n                    .attr(\"height\", layout.size()[1])\n                    .append(\"g\")\n                    .attr(\"transform\", \"translate(\" + layout.size()[0] / 2 + \",\" + layout.size()[1] / 2 + \")\")\n                    .selectAll(\"text\")\n                    .data(words)\n                    .enter().append(\"text\")\n                    .style(\"font-size\", d => d.size + \"px\")\n                    .style(\"font-family\", \"Impact\")\n                    .style(\"fill\", color)\n                    .attr(\"text-anchor\", \"middle\")\n                    .attr(\"transform\", d => \"translate(\" + [d.x, d.y] + \")rotate(\" + d.rotate + \")\")\n                    .text(d => d.word)\n                    .on(\"mouseover\", mouseover)\n                    .on(\"mouseout\", mouseout)\n                    .attr(\"class\", \"word\");\n            }\n\n            function darkenColor(d){\n                return d3.rgb(color(d)).darker(1);\n            }\n\n            function mouseover(event, d) {\n                const totalWords = d3.sum(words, d => d.frequency);\n                const percentage = (d.frequency / totalWords * 100).toFixed(2);\n                d3.select(event.target)\n                    .transition()\n                    .duration(300)\n                    .style(\"fill\", () => darkenColor(d))\n                    .style(\"font-size\", (d.size + 5) + \"px\");\n                setTooltip({content: `${d.word}: ${d.frequency} (${percentage}%)`, visibility: true, x: event.clientX, y: event.clientY});\n            }\n\n            function mouseout(event, d) {\n                d3.select(event.target)\n                    .transition()\n                    .duration(300)\n                    .style(\"font-size\", d.size + \"px\")\n                    .style(\"fill\", () => color(d));\n                setTooltip({...tooltip, visibility: false});\n            }\n\n            layout.start();\n        });\n    }, [filepath, category]);\n\n    const getColorScale = (category) => {\n        switch (category) {\n            case \"environmental\":\n                return d3.interpolateGreens;\n            case \"social\":\n                return d3.interpolateOranges;\n            case \"governance\":\n                return d3.interpolateBlues;\n            default:\n                return d3.interpolateBlues;\n        }\n    };\n    \n    return (\n        <div>\n            <div ref={ref}></div>\n            {tooltip.visibility && \n                <div ref={tooltipRef} style={{\n                    position: \"absolute\",\n                    left: tooltip.x,\n                    top: tooltip.y,\n                    background: \"rgba(0, 0, 0, 0.7)\",\n                    color: \"#fff\",\n                    padding: \"3px 8px\",\n                    borderRadius: \"4px\",\n                    pointerEvents: \"none\",\n                    fontSize: \"14px\",\n                    transform: 'translate(-50%, -100%)'\n                }}>{tooltip.content}</div>\n            }\n        </div>\n    );\n};\n\nexport default WordCloud;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}