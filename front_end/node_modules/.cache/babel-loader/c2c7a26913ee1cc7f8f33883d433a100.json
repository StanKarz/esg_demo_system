{"ast":null,"code":"import _slicedToArray from \"/Users/stan/Desktop/esg_demo_system/front_end/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/Users/stan/Desktop/esg_demo_system/front_end/src/pages/WordCloud.js\";\nimport React, { useEffect, useRef } from 'react';\nimport * as d3 from 'd3';\nimport d3Cloud from 'd3-cloud';\nvar WordCloud = function WordCloud(_ref) {\n  var filepath = _ref.filepath,\n    category = _ref.category;\n  var ref = useRef();\n  var getColorScale = function getColorScale(category) {\n    switch (category) {\n      case \"environmental\":\n        return d3.interpolateGreens;\n      case \"social\":\n        return d3.interpolateOranges;\n      case \"governance\":\n        return d3.interpolateBlues;\n      default:\n        return d3.interpolateBlues;\n    }\n  };\n  useEffect(function () {\n    fetch(\"http://localhost:3000/word-cloud/\".concat(btoa(filepath), \"/\").concat(category)).then(function (response) {\n      return response.json();\n    }).then(function (data) {\n      if (data.error) {\n        console.error(data.error);\n        return;\n      }\n      var words = Object.entries(data).map(function (_ref2) {\n        var _ref3 = _slicedToArray(_ref2, 2),\n          word = _ref3[0],\n          frequency = _ref3[1];\n        return {\n          word: word,\n          frequency: frequency\n        };\n      });\n      var width = 1000;\n      var height = 720;\n      var colorInterpolate = getColorScale(category);\n      var color = function color(d) {\n        return colorInterpolate(d.frequency / d3.max(words, function (d) {\n          return d.frequency;\n        }) * 0.7 + 0.35);\n      };\n      var fontSize = d3.scalePow().exponent(0.5).domain([0, d3.max(words, function (d) {\n        return d.frequency;\n      })]).range([10, 100]);\n      var layout = d3Cloud().size([width, height]).words(words).padding(7).rotate(function () {\n        return Math.round(Math.random()) * 90;\n      }).font(\"Impact\").fontSize(function (d) {\n        return fontSize(d.frequency);\n      }).on(\"end\", draw);\n      function draw(words) {\n        d3.select(ref.current).html(\"\").append(\"svg\").attr(\"width\", layout.size()[0]).attr(\"height\", layout.size()[1]).append(\"g\").attr(\"transform\", \"translate(\" + layout.size()[0] / 2 + \",\" + layout.size()[1] / 2 + \")\").selectAll(\"text\").data(words).enter().append(\"text\").style(\"font-size\", function (d) {\n          return d.size + \"px\";\n        }).style(\"font-family\", \"Impact\").style(\"fill\", color).attr(\"text-anchor\", \"middle\").attr(\"transform\", function (d) {\n          return \"translate(\" + [d.x, d.y] + \")rotate(\" + d.rotate + \")\";\n        }).text(function (d) {\n          return d.word;\n        });\n      }\n      layout.start();\n    });\n  }, [filepath, category]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: ref,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  });\n};\nexport default WordCloud;","map":{"version":3,"names":["React","useEffect","useRef","d3","d3Cloud","WordCloud","_ref","filepath","category","ref","getColorScale","interpolateGreens","interpolateOranges","interpolateBlues","fetch","concat","btoa","then","response","json","data","error","console","words","Object","entries","map","_ref2","_ref3","_slicedToArray","word","frequency","width","height","colorInterpolate","color","d","max","fontSize","scalePow","exponent","domain","range","layout","size","padding","rotate","Math","round","random","font","on","draw","select","current","html","append","attr","selectAll","enter","style","x","y","text","start","createElement","__self","_this","__source","fileName","_jsxFileName","lineNumber","columnNumber"],"sources":["/Users/stan/Desktop/esg_demo_system/front_end/src/pages/WordCloud.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport * as d3 from 'd3';\nimport d3Cloud from 'd3-cloud';\n\nconst WordCloud = ({ filepath, category }) => {\n    const ref = useRef();\n\n    const getColorScale = (category) => {\n        switch (category) {\n            case \"environmental\":\n                return d3.interpolateGreens;\n            case \"social\":\n                return d3.interpolateOranges;\n            case \"governance\":\n                return d3.interpolateBlues;\n            default:\n                return d3.interpolateBlues;\n        }\n    }\n\n    useEffect(() => {\n        fetch(`http://localhost:3000/word-cloud/${btoa(filepath)}/${category}`)\n        .then(response => response.json())\n        .then(data => {\n            if (data.error) {\n                console.error(data.error);\n                return;\n            }\n\n            const words = Object.entries(data).map(([word, frequency]) => ({word, frequency}));\n\n            var width = 1000;\n            var height = 720;\n            var colorInterpolate = getColorScale(category);\n            var color = d => colorInterpolate((d.frequency / d3.max(words, d => d.frequency)) * 0.7 + 0.35);\n\n            var fontSize = d3.scalePow().exponent(0.5).domain([0, d3.max(words, d => d.frequency)]).range([10,100]);\n            var layout = d3Cloud().size([width, height]).words(words).padding(7).rotate(() => Math.round(Math.random()) * 90).font(\"Impact\").fontSize(d => fontSize(d.frequency)).on(\"end\", draw);\n\n            function draw(words) {\n                d3.select(ref.current).html(\"\").append(\"svg\")\n                .attr(\"width\", layout.size()[0])\n                .attr(\"height\", layout.size()[1])\n                .append(\"g\")\n                .attr(\"transform\", \"translate(\" + layout.size()[0] / 2 + \",\" + layout.size()[1] / 2 + \")\")\n                .selectAll(\"text\")\n                .data(words)\n                .enter().append(\"text\")\n                .style(\"font-size\", d => d.size + \"px\")\n                .style(\"font-family\", \"Impact\")\n                .style(\"fill\", color)\n                .attr(\"text-anchor\", \"middle\")\n                .attr(\"transform\", d => \"translate(\" + [d.x, d.y] + \")rotate(\" + d.rotate + \")\")\n                .text(d => d.word);\n            }\n\n            layout.start();\n        });\n    }, [filepath, category]);\n\n    return (\n        <div ref={ref}>\n            {/* This is where your word cloud will be rendered */}\n        </div>\n    );\n};\n\nexport default WordCloud;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}